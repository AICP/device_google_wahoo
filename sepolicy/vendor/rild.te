binder_call(rild, per_mgr)

vndbinder_use(rild)

allow rild qmuxd_socket:dir w_dir_perms;
allow rild qmuxd_socket:sock_file create_file_perms;

allow rild netmgrd_socket:dir search;
unix_socket_connect(rild, netmgrd, netmgrd)

allow rild vendor_file:file { execute_no_trans lock };

allow rild per_mgr_service:service_manager find;

add_hwservice(rild, vnd_ims_radio_hwservice)
add_hwservice(rild, vnd_qcrilhook_hwservice)

allow rild self:socket ioctl;
allowxperm rild self:socket ioctl msm_sock_ipc_ioctls;
allow rild time_daemon:unix_stream_socket connectto;

# TODO(b/36718031): Remove this once radio no longer communicates with rild over sockets.
typeattribute rild socket_between_core_and_vendor_violators;
# TODO(b/62343727): Remove this once radio<->rild is hidlized
# This is added so we don't regress after the exact same rule is removed
# from system/sepolicy/public/radio.te for treble devices.
unix_socket_connect(radio, rild, rild)

userdebug_or_eng(`
  domain_auto_trans(rild, smlog_dump_exec, smlog_dump)
')
